<!DOCTYPE html>
<html>
<head>
    <title>NYC ODCV Opportunity Rankings | R-Zero</title>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --rzero-primary: #00769d;
            --rzero-primary-dark: #005f7e;
            --rzero-light-blue: #f0f7fa;
            --rzero-background: #f4fbfd;
        }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: var(--rzero-background); 
        }
        
        .container { max-width: 1400px; margin: 0 auto; }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 118, 157, 0.08);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .logo-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        h1 { 
            color: var(--rzero-primary); 
            margin: 0;
            font-size: 2.5em;
            font-weight: 700;
        }
        
        .subtitle { 
            color: #666; 
            margin: 10px 0 0 0;
            font-size: 1.1em;
        }
        
        .stats { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        
        .stat-card { padding: 15px; }
        .stat-value { font-size: 1.8em; }
        .stat-label { font-size: 0.9em; color: #666; }
        
        .info-box { 
            background: #f8f8f8;
            border: 1px solid #ddd;
            padding: 15px; 
            margin-bottom: 20px;
        }
        
        .info-box h2 { 
            color: var(--rzero-primary); 
            margin-top: 0; 
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .portfolio-box { 
            background: white;
            border: 1px solid rgba(0, 118, 157, 0.2);
            padding: 30px; 
            border-radius: 12px; 
            margin-bottom: 30px; 
        }
        
        .portfolio-box h2 { 
            color: var(--rzero-primary); 
            margin-top: 0; 
        }
        
        .portfolio-tile:hover {
            background-color: rgba(0, 118, 157, 0.15) !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 118, 157, 0.2);
        }
        
        .search-box { 
            width: 100%; 
            padding: 15px; 
            font-size: 16px; 
            border: 2px solid rgba(0, 118, 157, 0.2); 
            border-radius: 8px; 
            margin-bottom: 20px;
            font-family: 'Inter', sans-serif;
            transition: border-color 0.2s ease;
        }
        
        .search-box:focus {
            outline: none;
            border-color: var(--rzero-primary);
        }
        
        .table-wrapper {
            overflow-x: auto;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 118, 157, 0.08);
        }
        
        table { 
            width: 100%; 
            background: white; 
            border-collapse: collapse; 
            min-width: 1100px;
        }
        
        table a {
            color: var(--rzero-primary);
            text-decoration: none;
            transition: all 0.2s ease;
        }
        
        table a:hover {
            text-decoration: underline;
            color: var(--rzero-primary-dark);
        }
        
        th { 
            background: var(--rzero-primary); 
            color: white; 
            padding: 14px; 
            text-align: left; 
            cursor: pointer; 
            position: sticky; 
            top: 0;
            font-weight: 600;
            white-space: nowrap;
        }
        
        td { 
            padding: 10px; 
            border-bottom: 1px solid #eee; 
        }
        
        .yes { color: #38a169; font-weight: bold; }
        .no { color: #dc3545; font-weight: bold; }
        
        a { 
            color: var(--rzero-primary); 
            text-decoration: none;
            font-weight: 500;
        }
        
        
        .urgent { 
            color: #dc3545; 
            font-weight: bold; 
        }
        
        .rzero-badge {
            display: inline-block;
            background: var(--rzero-primary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        /* Thumbnail styles */
        .thumb-cell { 
            width: 80px; 
            padding: 8px !important; 
            text-align: center;
        }

        .building-thumb { 
            width: 60px; 
            height: 60px; 
            object-fit: cover; 
            border-radius: 8px; 
            box-shadow: 0 2px 8px rgba(0, 118, 157, 0.15);
            transition: transform 0.2s ease;
            cursor: pointer;
        }


        .no-thumb { 
            width: 60px; 
            height: 60px; 
            background: var(--rzero-light-blue); 
            border: 1px solid rgba(0, 118, 157, 0.2);
            border-radius: 8px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #999;
            font-size: 10px;
        }
        
        /* Filter button styles */
        .filter-btn {
            padding: 10px 15px;
            background: white;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .filter-btn:active {
            transform: translateY(0);
        }
        
        /* Sticky header enhancement */
        .table-wrapper {
            position: relative;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
            overflow-x: auto;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 118, 157, 0.08);
        }
        
        thead {
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .table-wrapper::-webkit-scrollbar {
            width: 12px;
        }
        
        .table-wrapper::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 6px;
        }
        
        .table-wrapper::-webkit-scrollbar-thumb {
            background: var(--rzero-primary);
            border-radius: 6px;
        }
        
        .table-wrapper::-webkit-scrollbar-thumb:hover {
            background: var(--rzero-primary-dark);
        }
        
        /* Savings tier colors */
        .savings-high {
            color: #1b5e20;
            font-weight: 700;
            position: relative;
        }
        
        .savings-high::before {
            content: 'â˜…';
            position: absolute;
            left: -15px;
            color: #ffc107;
        }
        
        .savings-medium {
            color: #f57c00;
            font-weight: 600;
        }
        
        .savings-low {
            color: #616161;
        }
        
        tr:nth-child(-n+10) .savings-high {
            background: linear-gradient(90deg, transparent 0%, rgba(76, 175, 80, 0.1) 50%, transparent 100%);
            padding: 4px 8px;
            border-radius: 4px;
        }
        
        
        /* Back to top button */
        #backToTop {}
        
        /* Animations */
        @keyframes slideUp {
            from {
                transform: translateX(-50%) translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100px);
                opacity: 0;
            }
        }
        
        @keyframes highlightPulse {
            0% { background-color: #fff59d; }
            50% { background-color: #ffeb3b; }
            100% { background-color: #ffeb3b; }
        }
        
        mark {
            animation: highlightPulse 1s ease-in-out;
        }
        
        .new-features {
            background: #fff3cd;
            border: 2px solid #ffeeba;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .new-features h3 {
            color: #856404;
            margin-top: 0;
        }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBt_cBgP_yqhIzUacpoz6TAVupvhmA0ZBA&libraries=places&callback=initMap&loading=async" async defer></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-header">
                <img src="https://rzero.com/wp-content/uploads/2021/10/rzero-logo-pad.svg" alt="R-Zero Logo" class="rzero-logo" style="width: 200px; height: 50px;">
            </div>
            <h1>Prospector: NYC</h1>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value">1</div>
                <div class="stat-label">Buildings with BAS</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" style="color: #dc3545;">0</div>
                <div class="stat-label">Buildings facing $0.0M 2026 LL97 Penalties</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" style="color: #2e7d32;">$0.5M</div>
                <div class="stat-label">Year One Savings</div>
            </div>
        </div>
        
        <div class="portfolio-box">
            <h2>Top Portfolios</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
    
                <div class="portfolio-tile" onclick="filterByOwner('Durst Organization')" style="background: var(--rzero-light-blue); padding: 20px; border-radius: 8px; border: 1px solid rgba(0, 118, 157, 0.2); cursor: pointer; transition: all 0.2s ease;">
                    <strong style="color: var(--rzero-primary);">Durst Organization</strong><br>
                    <span style="color: #666;">1 buildings â€¢ $0.5M savings</span>
                </div>
        
            </div>
        </div>
    
        <div class="info-box">
            <h2 onclick="toggleSection('rankings')" style="cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
                Understanding the Rankings 
                <span id="rankings-arrow" style="font-size: 0.8em;">â–¼</span>
            </h2>
            <div id="rankings-content" style="display: none;">
                <p>Buildings are ranked by <strong>SALES READINESS</strong>, not just savings amount. The scoring system (110 points total):</p>
                <ul style="line-height: 1.8;">
                    <li><strong>Financial Impact (40 pts):</strong> 10-year value of ODCV savings + avoided LL97 penalties</li>
                    <li><strong>BAS Infrastructure (30 pts):</strong> No BAS = 0 points (major barrier to sale)</li>
                    <li><strong>Owner Portfolio (20 pts):</strong> Large portfolios score higher (one pitch â†’ multiple buildings)</li>
                    <li><strong>Implementation Ease (10 pts):</strong> Fewer tenants + larger floors = easier installation</li>
                    <li><strong>Prestige Factors (10 pts):</strong> LEED certification, Energy Star ambitions, Class A buildings</li>
                </ul>
                <p style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px; border: 1px solid #ffeeba;">
                    <strong>Example:</strong> A building with $1.4M savings but no BAS ranks #123, while a $539K building with perfect infrastructure ranks #1. Focus on the ready buyers!
                </p>
            </div>
        </div>

        <input type="text" class="search-box" id="search" placeholder="Search by address, owner, property manager" onkeyup="filterTable()">
        
        <div class="table-wrapper">
        <table id="buildingTable">
            <thead>
                <tr>
                    <th class="thumb-cell"></th>
                    <th onclick="sortTable(1)">Rank â†•</th>
                    <th onclick="sortTable(2)">Building Address â†•</th>
                    <th onclick="sortTable(3)">Owner â†•</th>
                    <th onclick="sortTable(4)">Property Manager â†•</th>
                    <th onclick="sortTable(5)">Class â†•</th>
                    <th onclick="sortTable(6)">BAS â†•</th>
                    <th onclick="sortTable(7)">Annual Savings â†•</th>
                    <th onclick="sortTable(8)">Score â†•</th>
                    <th onclick="sortTable(9)">2026 Penalty â†•</th>
                    <th>View</th>
                </tr>
            </thead>
            <tbody>

                <tr data-search="1472 broadway, new york, ny 10036 | 1472 broadway | 141 w 42 st | 143 w 42 st | 145 w 42 st | 147 w 42 st | 149 w 42 st | 151 w 42 st | 153 w 42 st | 155 w 42 st | 157 w 42 st | 1472 broadway | 1474 broadway | 1476 broadway | 1478 broadway | 1480 broadway | 1482 broadway | 1484 broadway | 1486 broadway | 1488 broadway | 1490 broadway | 4 times sq | 138 w 43 st | 140 w 43 st | 142 w 43 st | 144 w 43 st | 146 w 43 st | 148 w 43 st | 150 w 43 st | 152 w 43 st | 154 w 43 st | 156 w 43 st | 158 w 43 st | durst organization | durst organization | 1009950005" data-occupancy="90">
                    <td class="thumb-cell"><img src="https://raw.githubusercontent.com/fmillerrzero/nyc-odcv-prospector/main/hero_thumbnails/1009950005_thumb.jpg" alt="1472 Broadway, New York, NY 10036" class="building-thumb" onclick="window.location.href='1009950005_1472 Broadway, New York, NY 10036.html'"></td>
                    <td><span class="rzero-badge">#1</span></td>
                    <td>1472 Broadway, New York, NY 10036</td>
                    <td><a href="#" onclick="filterByOwner('Durst Organization')" style="color: var(--rzero-primary); text-decoration: none; cursor: pointer;">Durst Organization</a></td>
                    <td><a href="#" onclick="filterByManager('Durst Organization')" style="color: var(--rzero-primary); text-decoration: none; cursor: pointer;">Durst Organization</a></td>
                    <td>A</td>
                    <td class="yes">yes</td>
                    <td data-value="539290.0599999999" class="savings-high">$539,290</td>
                    <td>98.0</td>
                    <td data-value="0.0" class="">$0</td>
                    <td>
                        <a href="1009950005_1472 Broadway, New York, NY 10036.html">View Report â†’</a>
                    </td>
                </tr>

            </tbody>
        </table>
        </div>
        
        <!-- Back to Top Button -->
        <button id="backToTop" onclick="scrollToTop()" style="
            position: fixed;
            bottom: 80px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: var(--rzero-primary);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
        ">
            <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>
            </svg>
        </button>
    </div>

    <script>
    function initMap() {
        const searchInput = document.getElementById('search');
        if (searchInput) {
            const autocomplete = new google.maps.places.Autocomplete(searchInput, {
                types: ['address'],
                componentRestrictions: { country: 'US' }
            });
        }
    }
    
    let activeOwnerFilter = null;
    let sortDir = {};
    
    function sortTable(col) {
        const tbody = document.querySelector('#buildingTable tbody');
        const rows = Array.from(tbody.querySelectorAll('tr'));
        
        sortDir[col] = !sortDir[col];
        
        rows.sort((a, b) => {
            let aVal, bVal;
            
            if (col === 7 || col === 9) {  // Annual Savings or 2026 Penalty columns
                aVal = parseFloat(a.cells[col].getAttribute('data-value') || 0);
                bVal = parseFloat(b.cells[col].getAttribute('data-value') || 0);
            } else if (col === 1 || col === 8) {  // Rank or Score columns
                aVal = parseFloat(a.cells[col].textContent.replace('#', '') || 0);
                bVal = parseFloat(b.cells[col].textContent.replace('#', '') || 0);
            } else {
                aVal = (a.cells[col].textContent || '').toLowerCase();
                bVal = (b.cells[col].textContent || '').toLowerCase();
            }
            
            return sortDir[col] ? 
                (aVal > bVal ? 1 : -1) : 
                (aVal < bVal ? 1 : -1);
        });
        
        rows.forEach(row => tbody.appendChild(row));
    }
    
    function filterByOwner(ownerName) {
        const rows = document.querySelectorAll('#buildingTable tbody tr');
        rows.forEach(row => {
            const ownerCell = row.cells[3]; // Owner column index
            const isMatch = ownerCell && ownerCell.textContent.trim() === ownerName;
            row.style.display = isMatch ? '' : 'none';
        });
    }

    function filterByManager(managerName) {
        const rows = document.querySelectorAll('#buildingTable tbody tr');
        rows.forEach(row => {
            const managerCell = row.cells[4]; // Property Manager column index
            const isMatch = managerCell && managerCell.textContent.trim() === managerName;
            row.style.display = isMatch ? '' : 'none';
        });
    }
    
    function filterTable() {{
        const input = document.getElementById('search').value.toLowerCase();
        const rows = document.querySelectorAll('#buildingTable tbody tr');
        
        // Clear owner filter if user starts typing
        if (input && activeOwnerFilter) {{
            activeOwnerFilter = null;
            // Remove active styling from all tiles
            document.querySelectorAll('.portfolio-tile').forEach(tile => {{
                tile.style.outline = '';
                tile.style.boxShadow = '';
            }});
        }}
        
        rows.forEach(row => {{
            const searchText = row.getAttribute('data-search');
            const matchesSearch = searchText.includes(input);
            
            // Check if row matches owner filter (if active)
            let matchesOwner = true;
            if (activeOwnerFilter) {{
                const ownerCell = row.cells[3];
                matchesOwner = ownerCell && ownerCell.textContent === activeOwnerFilter;
            }}
            
            row.style.display = (matchesSearch && matchesOwner) ? '' : 'none';
        }});
    }}
        const tbody = document.querySelector('#buildingTable tbody');
        const rows = Array.from(tbody.querySelectorAll('tr'));
        
        sortDir[col] = !sortDir[col];
        
        rows.sort((a, b) => {{
            let aVal, bVal;
            
            if (col === 7 || col === 9) {{  // Annual Savings or 2026 Penalty columns
                aVal = parseFloat(a.cells[col].getAttribute('data-value') || 0);
                bVal = parseFloat(b.cells[col].getAttribute('data-value') || 0);
            }} else if (col === 1 || col === 8) {{  // Rank or Score columns
                aVal = parseFloat(a.cells[col].textContent.replace('#', '') || 0);
                bVal = parseFloat(b.cells[col].textContent.replace('#', '') || 0);
            }} else {{
                aVal = (a.cells[col].textContent || '').toLowerCase();
                bVal = (b.cells[col].textContent || '').toLowerCase();
            }}
            
            return sortDir[col] ? 
                (aVal > bVal ? 1 : -1) : 
                (aVal < bVal ? 1 : -1);
        }});
        
        rows.forEach(row => tbody.appendChild(row));
    }}
    
    
    // Toggle collapsible sections
    function toggleSection(sectionId) {{
        const content = document.getElementById(sectionId + '-content');
        const arrow = document.getElementById(sectionId + '-arrow');
        
        if (content.style.display === 'none' || content.style.display === '') {{
            content.style.display = 'block';
            arrow.textContent = 'â–²';
        }} else {{
            content.style.display = 'none';
            arrow.textContent = 'â–¼';
        }}
    }}
    
    // Filter by owner when clicking portfolio tiles
    function filterByOwner(ownerName) {{
        const rows = document.querySelectorAll('#buildingTable tbody tr');
        const searchBox = document.getElementById('search');
        
        if (activeOwnerFilter === ownerName) {{
            // If clicking the same owner, reset the filter
            activeOwnerFilter = null;
            searchBox.value = '';
            rows.forEach(row => {{
                row.style.display = '';
            }});
            // Remove active styling from all tiles
            document.querySelectorAll('.portfolio-tile').forEach(tile => {{
                tile.style.outline = '';
                tile.style.boxShadow = '0 4px 12px rgba(0, 118, 157, 0.2)';
            }});
        }} else {{
            // Apply new owner filter
            activeOwnerFilter = ownerName;
            searchBox.value = ''; // Clear search box
            
            rows.forEach(row => {{
                const ownerCell = row.cells[3]; // Owner column (0-indexed)
                const isMatch = ownerCell && ownerCell.textContent === ownerName;
                row.style.display = isMatch ? '' : 'none';
            }});
            
            // Add active styling to clicked tile
            document.querySelectorAll('.portfolio-tile').forEach(tile => {{
                const tileOwner = tile.querySelector('strong').textContent;
                if (tileOwner === ownerName) {{
                    tile.style.outline = '3px solid var(--rzero-primary)';
                    tile.style.boxShadow = '0 4px 16px rgba(0, 118, 157, 0.4)';
                }} else {{
                    tile.style.outline = '';
                    tile.style.boxShadow = '0 4px 12px rgba(0, 118, 157, 0.2)';
                }}
            }});
        }}
    }}
    
    // Back to top
    function scrollToTop() {{
        const tableWrapper = document.querySelector('.table-wrapper');
        const startPosition = tableWrapper.scrollTop;
        const startTime = performance.now();
        const duration = 500;
        
        function animation(currentTime) {{
            const elapsed = currentTime - startTime;
            const progress = Math.min(elapsed / duration, 1);
            const easeOutCubic = 1 - Math.pow(1 - progress, 3);
            
            tableWrapper.scrollTop = startPosition * (1 - easeOutCubic);
            
            if (progress < 1) {{
                requestAnimationFrame(animation);
            }}
        }}
        
        requestAnimationFrame(animation);
    }}
    
    // Show/hide back to top based on scroll
    document.querySelector('.table-wrapper').addEventListener('scroll', function() {{
        const scrollTop = this.scrollTop;
        const backToTopBtn = document.getElementById('backToTop');
        
        if (scrollTop > 300) {{
            backToTopBtn.style.display = 'block';
            backToTopBtn.style.transform = 'scale(1)';
        }} else {{
            backToTopBtn.style.transform = 'scale(0)';
            setTimeout(() => {{
                if (scrollTop <= 300) {{
                    backToTopBtn.style.display = 'none';
                }}
            }}, 300);
        }}
        
        // Add progress indicator
        const scrollHeight = this.scrollHeight - this.clientHeight;
        const scrollProgress = (scrollTop / scrollHeight) * 100;
        backToTopBtn.style.background = `conic-gradient(var(--rzero-primary) ${{scrollProgress}}%, var(--rzero-primary-dark) ${{scrollProgress}}%)`;
    }});
    
    // Dynamic shadow on scroll
    document.querySelector('.table-wrapper').addEventListener('scroll', function(e) {{
        const thead = document.querySelector('thead');
        if (e.target.scrollTop > 0) {{
            thead.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.15)';
        }} else {{
            thead.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.1)';
        }}
    }});
    
    
    // Initialize on page load
    window.addEventListener('DOMContentLoaded', function() {{
        // Add tooltips to high-value savings
        document.querySelectorAll('td[data-value]').forEach(cell => {{
            const value = parseFloat(cell.getAttribute('data-value'));
            if (value >= 1000000) {{
                cell.title = `${{(value/1000000).toFixed(2)}}M annual savings - TOP OPPORTUNITY`;
            }}
        }});
    }});
    </script>
</body>
</html>